레거시 시스템 분석과 AI 페어 프로그래밍 활용 기록

오늘은 강사님의 조언을 바탕으로 AI를 활용해 레거시 시스템을 분석하고 인수 테스트를 설계하는 전체 과정을 기록으로 남겨본다. AI에게 무작정 코드를 짜라고 하기보다, 컨텍스트를 주고 문서를 먼저 작성하게 한 뒤 이를 바탕으로 코드를 유도하는 방식으로 진행했다.

## 1. 시스템 분석 및 구조 문서화

먼저 AI에게 시스템 분석 방법에 대한 조언을 구했다. 현재 시스템의 전반적인 구조와 서비스의 목적을 확실히 이해하기 위해, 분석 내용을 바탕으로 `SYSTEM_OVERVIEW.md`를 작성하도록 했다. 이어서 인수 테스트를 설계하는 방식에 대한 설명도 문서화하여 프로젝트의 뼈대를 잡았다.

## 2. 테스트 전략 수립을 위한 프롬프트 엔지니어링

현재 레거시 코드 인수 테스트 프로젝트를 맡고 있다는 상황을 AI에게 명확히 인지시키고, 아래 요구사항을 바탕으로 `TEST_STRATEGY.md`를 작성하도록 프롬프트를 구성했다.

- **테스트 전략 문서**: 검증할 행위 목록과 선택 기준, 테스트 데이터 준비/정리 전략, 검증 전략, 주요 의사결정 과정 포함
- **테스트 코드 작성**: 단순히 5개의 테스트가 아닌, '최소 5개 이상의 행위'를 검증하는 테스트 작성
- **작업 흐름 제어**: 무작정 코드를 짜지 말고, 기존 문서들을 분석한 뒤 어떤 식으로 진행할지 먼저 나에게 설명하고, 내 동의를 얻은 후에만 작업을 시작하도록 지시

## 3. AI 제어 및 테스트 책임 분리 (트러블 슈팅)

작업 과정에서 두 가지 문제를 바로잡았다.

- **프로덕션 코드 수정 제어**: AI가 테스트 전략을 바탕으로 main 폴더의 프로덕션 코드까지 수정하려는 돌발 행동을 보였다. 즉시 `CLAUDE.md` 파일에 "main 폴더는 읽기 전용(Read-only)이며 수정하지 말 것"이라는 규칙을 명시했고, `TEST_STRATEGY.md` 역시 순수하게 테스트 전략만 담도록 목적을 분명히 제한했다.

- **인수/단위 테스트 분리**: AI가 작성한 인수 테스트 코드 중에 수량 체크 로직(`assertThat(unchanged.getQuantity()).isEqualTo(100);`)이 포함되어 있었다. 인수 테스트보다는 단위 테스트에 가까운 성격이라 판단되어 AI에게 "이게 단위 테스트가 맞지 않냐"고 물어보니 AI도 이를 인정했다. 즉시 인수 테스트와 단위 테스트의 책임을 분리하여 코드를 재작성하도록 지시하고, 변경된 방향성을 `TEST_STRATEGY.md`에 반영했다.

## 4. Git 컨벤션 자동화 시도

AI의 Skills 기능을 활용해 Git Commit Convention을 준수하는 자동 커밋 메시지 생성 기능을 구축해 보았다.
